<div class="row wrapper border-bottom white-bg page-heading">
    <div class="col-lg-12">
        <img alt="image" class="img-responsive" src="<%= image_url 'headerlogo.jpg' %> " height="50px" />
        <!--  <div class="col-lg-6">
        <img alt="image" src="<%= image_url 'l3.jpg' %>" style="margin-left:-15px;" />
        </div>
        <div class="col-lg-2">
        <img alt="image" src="<%= image_url 'l2.jpg' %>" style="align:center;"/>
        </div>
        <div class="col-lg-4">
            <img alt="image" src="<%= image_url 'l1.jpg' %>" style="margin-top:15px;margin-left:220px;" />
        </div>  -->
     
        <div class="clearfix"></div>
         <ol class="breadcrumb" style="background:#F3F3F4; padding:10px;">
          <!--  <li>
                <a href="<%= url_for :controller => 'source_data', :action => 'chart' %>">Home</a>
            </li>
            <li>
                <a href="<%= url_for :controller => 'madein_ksa', :action => 'show' %>">MADE IN KSA Searcher</a>
            </li>
             <li class="active">
                <b>MADE IN KSA Details</b>
            </li>-->
            <li>
             <%- if I18n.locale==:ar%>
                 <span class="">
                  <% @ar_breadcrum_home = Language.select("language_property").where("language_id = ?  AND language_type = ? ", '14','ar')%>
                  <% @ar_breadcrum_home.each do |ar_breadcrum_home|%>
                    <a href="<%= url_for :controller => 'source_data', :action => 'chart' %>"><%= ar_breadcrum_home.language_property %></a>

                   <% end %>
                </span>
            <% else %>
                <span class="">
                  <% @en_breadcrum_home = Language.select("language_property").where("language_id= ? AND language_type = ?",'14','en')%>
                  <% @en_breadcrum_home.each do |en_breadcrum_home|%>
                    <a href="<%= url_for :controller => 'source_data', :action => 'chart' %>"><%= en_breadcrum_home.language_property %></a>
            <% end %>
                </span>
            <% end -%>
            </li>
            <li>
             <%- if I18n.locale==:ar%>
                 <span class="">
                  <% @ar_breadcrum_search = Language.select("language_property").where("language_id = ?  AND language_type = ? ", '40','ar')%>
                  <% @ar_breadcrum_search.each do |ar_breadcrum_home|%>
                    <a href="<%= url_for :controller => 'madein_ksa', :action => 'show' %>"><%= ar_breadcrum_home.language_property %></a>

                   <% end %>
                </span>
            <% else %>
                <span class="">
                  <% @ar_breadcrum_search = Language.select("language_property").where("language_id= ? AND language_type = ?",'40','en')%>
                  <% @ar_breadcrum_search.each do |en_breadcrum_home|%>
                    <a href="<%= url_for :controller => 'madein_ksa', :action => 'show' %>"><%= en_breadcrum_home.language_property %></a>
            <% end %>
                </span>
            <% end -%>
          
            </li>
             <li class="active">
                <%- if I18n.locale== :ar %>
                <span class="">
                  <% @ar_breadcrum_view = Language.select("language_property").where("language_id = ?  AND language_type = ? ", '17','ar')%>
                  <% @ar_breadcrum_view.each do |ar_breadcrum_view|%>
                   <%= ar_breadcrum_view.language_property %>

                   <% end %>
                </span>
              <% else %>
                <span class="">
                  <% @en_breadcrum_view = Language.select("language_property").where("language_id = ?  AND language_type = ? ", '17','en')%>
                  <% @en_breadcrum_view.each do |en_breadcrum_view|%>
                 <%= en_breadcrum_view.language_property %>

                   <% end %>
                </span>
              <% end -%>
            </li>
        </ol>
        
    </div>
</div>

<%= form_tag(view1_path,:method => "post", class: "navbar-form",:multipart => true,name:"myform") do %>

<% if @id %>

<div class="wrapper wrapper-content animated fadeInRight">
  <div class="row">
     <div class="col-lg-12">
        <div class="ibox" style="border:1px solid #21B6A8;">
          <div class="ibox-title" style="background:#21B6A8;color:#f3f3f4 !important;">
          <%- if I18n.locale== :ar %>
           <h3><b> تفاصيل مادية</b></h3>
                <% else %>
                <h3><b>   Material Details</b></h3>
                <% end -%>
              <div class="ibox-tools hide">
                  <a class="collapse-link" style="color:#f3f3f4 !important;">
                      <i class="fa fa-chevron-up"></i>
                  </a>
                 
                  <a class="close-link" style="color:#f3f3f4 !important;">
                      <i class="fa fa-times"></i>
                  </a>
              </div>
          </div>
          <div class="ibox-content">
            <table class="table table-bordered">
             <%@data.each do |a|%>
               <% created_date=a.datecreated %>
             <% lastmodified=a.lastmodified %>
             <% name=a.username %>
             <% lastmodifiedby=a.last_modified_by %>
             <% if lastmodified =="" %>
             <% date= created_date %>
             <% else %>
             <% date= lastmodified %>
             <% end %>
              <% if lastmodifiedby=="" %>
             <% lastname= name %>
             <% else %>
             <% lastname= lastmodifiedby %>
             <% end %>

                <tr>
                    <th>CMM MATERIAL NO</th>
                    <th>MATERIAL ID</th>
                    <th>DATE CREATED</th>
                    <th>IMAGE</th>
                    <th></th>
                  
                </tr>
                <tr>                
                    <td data-toggle="tooltip" data-html="true" title="Name : <%= lastname %> &#10;Date Created : <%= date %>"  style="cursor:pointer;"><%='KSA.MIK:'+a.cmm_material_no.to_s%>
                   <input type="hidden" name="cat_id" id="cmm_material_no" value="<%=a.cat_id%>" ></td>
                    <td data-toggle="tooltip" data-html="true" title="Name : <%= lastname %> &#10;Date Created : <%= date %>"  style="cursor:pointer;"><%=a.material_id%></td>
                    <td data-toggle="tooltip" data-html="true" title="Name : <%= lastname %> &#10;Date Created : <%= date %>"  style="cursor:pointer;"><%=a.datecreated%></td>
                   <td data-toggle="tooltip" data-html="true" title="Name : <%= lastname %> &#10;Date Created : <%= date %>"  style="cursor:pointer;"> 

                     <%#= ("<img id = 'pictureInput' width = '80' height = '80' alt = 'image' class = 'list_image' src='data:image/jpg;base64,%s'>" % Base64.encode64(@a.file_content)).html_safe %>
                   <%@image.each do |img|%>
                     <img alt="image" id ="imgprev" width = "80" height = "80" class="img-responsive" src="<%= image_url img.image_name %> "   />
                     <%=File.basename(img.image_name)%>
                    <% end %>
                  </td>
                 
                 <td>
                 <input type="file" id="pictureInput" name="pictureInput">
                  <br><br>
                    <%= submit_tag t('UPLOAD IMAGE'),:class=>"btn btn-primary",:id => "img_chk",:name => "img_chk"%>
                  </td>
                <%end %>
                </tr> 
            </table>
        </div>
      </div>
     </div>

      <div class="col-lg-12">
       <div class="ibox" style="border:1px solid #21B6A8;">
          <div class="ibox-title" style="background:#21B6A8;color:#f3f3f4 !important;">
                <%- if I18n.locale==:ar%>
                   <span class="">
                    <% @ar_breadcrum_desc = Language.select("language_property").where("language_id = ?  AND language_type = ? ", '43','ar')%>
                    <% @ar_breadcrum_desc.each do |ar_breadcrum_desc|%>
               <h3>   <b> <%= ar_breadcrum_desc.language_property %></b></h3>
                    <% end %>
                <% else %>
                      <% @ar_breadcrum_desc = Language.select("language_property").where("language_id= ? AND language_type = ?",'43','en')%>
                      <% @ar_breadcrum_desc.each do |en_breadcrum_desc|%>
                   <h3><b>   <%= en_breadcrum_desc.language_property %></b></h3>
                <% end %>
              <% end -%>
          </div>
          <div class="ibox-content">
            <table class="table table-bordered">
                <% for l in @len %>
              <%for c in @data%>

              <tr>
                <div class="col-lg-2">
                  <th><%=t('SHORT DESCRIPTION')%></th>
                </div>
                <div class="col-lg-8">
                  <td><div id="sh_desc" style="font-size:14px" ><%=c.short_description%></div>
                    <%= hidden_field_tag "id",c.cat_id %>
                    <%=hidden_field_tag "class",c.Class %>
                    <%=hidden_field_tag "len_sd",l.length_SD %>
                  </td>                
                </div>
                 <div classs="col-lg-2">
                  <td>
                    <% if l.length_SD=="" %>
                       <%= @length_SD=40 %>  
                      <% else %>
                    <%=@length_SD=(c.short_description.length).to_s+'/'+(l.length_SD) %>                
                    <% end %>                       
                  </td>
                  </div>
              </tr>
              <tr> 
              <div class="col-lg-2">
                  <th><%=t('LONG DESCRIPTION')%></th>
              </div>
             <td> <div id="lg_desc",size:"125*100" style="font-size:14px"> <%=c.long_description%></div>
                  <%= text_field_tag :cat_id, params[:cat_id], class: "hide", value: @id %>
                   <%=hidden_field_tag "class",c.Class %>
                  <%=hidden_field_tag "len_ld",l.length_LD %>
                 </td>
             
                <div classs="col-lg-2">
                   <td>   
                     <% if l.length_LD=="0" %>
                        <%= @length_LD=(c.long_description.length).to_s+'/'+"UNLIMITED" %> 
                      <% else %>
                        <%= @length_LD=(c.long_description.length).to_s+'/'+(l.length_LD) %> 
                    <% end %>
                  </td>
                </div> 
              </tr>
              <% end %>
              <% end %>
           </table>
        </div>
                    
          </div>
      </div>

      <div class="col-lg-12">
        <div class="tabs-container custom-tab" style="border:1px solid #21B6A8;">
                <ul class="nav nav-tabs" style="background:#21B6A8;" >
                    <li class="">
                  <%- if I18n.locale==:ar%>
                 
                  <% @ar_breadcrum_technical = Language.select("language_property").where("language_id = ?  AND language_type = ? ", '41','ar')%>
                  <% @ar_breadcrum_technical.each do |ar_breadcrum_technical|%>
                    <a data-toggle="tab" href="#tab-1" style="color:#f3f3f4 !important;"><h3><b><%= ar_breadcrum_technical.language_property %></b></h3></a>
                   <% end %>
               
            <% else %>
                
                  <% @ar_breadcrum_technical = Language.select("language_property").where("language_id= ? AND language_type = ?",'41','en')%>
                  <% @ar_breadcrum_technical.each do |en_breadcrum_technical|%>
                   <a data-toggle="tab" href="#tab-1" style="color:#f3f3f4 !important;"><h3><b><%= en_breadcrum_technical.language_property %></b></h3></a>
            <% end %>
               
            <% end -%>
            </li>

             <li class="">
                  <%- if I18n.locale==:ar%>
              
                  <% @ar_breadcrum_technical = Language.select("language_property").where("language_id = ?  AND language_type = ? ", '42','ar')%>
                  <% @ar_breadcrum_technical.each do |ar_breadcrum_technical|%>
                    <a data-toggle="tab" href="#tab-2" style="color:#f3f3f4 !important;"><h3><b><%= ar_breadcrum_technical.language_property %></b></h3></a>

                   <% end %>
             
            <% else %>
           
                  <% @ar_breadcrum_technical = Language.select("language_property").where("language_id= ? AND language_type = ?",'42','en')%>
                  <% @ar_breadcrum_technical.each do |en_breadcrum_technical|%>
                   <a data-toggle="tab" href="#tab-2" style="color:#f3f3f4 !important;"><h3><b><%= en_breadcrum_technical.language_property %></b></h3></a>
            <% end %>
             
<% end -%>
            </li>
             <div class="pull-right">
              <button type="button" class="btn btn-danger btn-xs more-button" id="toggle">Provenance</button>
            </ul>
             
        <div class="tab-content">
         <div id="tab-1" class="tab-pane active">
              <div class="panel-body">
                <span id="tech_spec" class="tech_spec" style="margin-left:100px !important;"></span>
                  <div class="row" style="padding-top:10px;">

                  <div id="change_class"></div>
                  
                        <table class="table table-bordered" id="change_class1" >
                    <thead>
                      <tr>
                        <th><%=t('Property')%></th>
                        <th><%=t('Value')%></th>
                        <th><%=t('Source')%></th>
                        <th><%=t('Name')%></th>
                        <th><%=t('Date Created')%></th>
                      </tr>
                    </thead>
                    <tbody>
                       <% for a in @data %>
                        <td><b><h3><%=t('Class')%></h3></b></td>
                        <td>  
                      <b> <%= link_to a.Class , {:controller => :source_data,:action => :dictionary_detail, :term => '',:esci => a.class_id}, :target => "_blank",:def =>'',:name => 'newclass',:id => 'newclass' %> <span class="text-danger" style="font-size: 16px;" %>  </b>
                       <button class="btn btn-info btn-xs"><a data-toggle="modal" href="#modal-form-newclass" ><%=t('BROWSE')%></a></button></td>
                        <% end %>
                      </tr>
                       
                        <tr>
                          <% for a in @data1 %>
                              <td style="font-size:13px;">
                             <b> <%= link_to a.property , {:controller => :source_data,:action => :dictionary_detail, :term => '',:esci => a.propertyRef}, :target => "_blank",:def =>'' %> <span class="text-danger" style="font-size: 16px;" %>  </b>
                              </td>
                              <td>                 
                              <%= text_field_tag "task[]",a['value'],class: "form-control",style: "font-size:14px"%><br/>
                              <%= hidden_field_tag "ids_to_update1[]", a['property'] %>
                              <%= hidden_field_tag "ids_to_update[]", a['Seq'] %>
                              <%= text_field_tag :cat_id, params[:cat_id], class: "form-control hide", value: @id %>
                              </td> 
                               <td><%=a.source%></td>
                              <td><%=a.name%></td> 
                             <td> <% if a.value!=''%><%=a.datecreated%><% end %></td> 
                        </tr>
                      <% end %>
                      </tbody>
                      </table>
                  </div>
               </div>
            </div>
        
            <div id="tab-2" class="tab-pane">
              <div class="panel-body">
                  <div class="row" style="padding-top:10px;">
                  <table class="table table-bordered">
                    <div class="row">
                      <tr>
                                  <tr><td colspan="3"><b><%=t('BUYER DATA')%></b></td></tr>
                                     <% for y in @data2 %>
                                    <tr>
                                       <%if y['property']=='BUYER REFERENCE'%>
                                         <td><b><%= link_to y.property , {:controller => :source_data,:action => :dictionary_detail, :esci => "0161-1#02-132378#1"}, :target => "_blank",:def =>'' %></b></td>
                                        <td colspan="2"><%= text_field_tag "bu1[]",y['value'].split(':')[0],class: "form-control" %>
                                       <%= text_field_tag "bu2[]",y['value'].split(':')[1],class: "form-control" %>
                                       <input type="hidden" name="add_text" id="add_text" value="add" onclick="add();" >
                                        <%= hidden_field_tag "bu[]",y['property'],class: "form-control" %>
                                         <%= hidden_field_tag "other_task4[]",y['Seq'],class: "form-control" %>
                                         <input type="hidden" name="buyer" id="buyer" value="0">
                                         </td>
                                        <% end %>
                                    </tr>
                                      <% end %>
                                    <tr><td colspan="3"><b><%=t('CLASSIFICATION')%></b></td></tr>
                                      <% for y in @data2%>
                                    <tr>
                                      <% if y.property=='UNSPSC' %> 
                                          <td><b><%= link_to y.property , {:controller => :source_data,:action => :dictionary_detail, :esci => "0161-1#02-132210#1"}, :target => "_blank",:def =>'' %></b></td>
                                       <td colspan="2">   
                                        <% if y.value.nil? %>                                   
                                        <%= text_field_tag "unspsc1",y.value,class: "form-control" %>
                                        <%= text_field_tag "unspsc2",y.value,class: "form-control" %>
                                        <%= text_field_tag "unspsc3",y.value,class: "form-control" %>
                                        <% else %>
                                         <%= text_field_tag "unspsc1",y.value.split(':')[0],class: "form-control" %>
                                        <%= text_field_tag "unspsc2",y.value.split(':')[1],class: "form-control" %>
                                        <%= text_field_tag "unspsc3",y.value.split(':')[2],class: "form-control" %>
                                        <% end %>
                                        <%= hidden_field_tag "unspsc",y.property,class: "form-control" %>
                                         <%= hidden_field_tag "unspsc_task4",y.Seq,class: "form-control" %></td>
                                      <% end %>
                                    </tr>
                                       <% end %>
                                       <% for y in @data2 %>
                                       <tr>
                                        <% if y['property']=='BRAND NAME' %>
                                          <td><b><%= link_to y.property , {:controller => :source_data,:action => :dictionary_detail, :esci => "0161-1#02-148126#1"}, :target => "_blank",:def =>'' %></b></td>
                                        <td colspan="2"><%= text_field_tag "bu1[]",y['value'],class: "form-control" %>
                                        <%= hidden_field_tag "bu[]",y['property'],class: "form-control" %>
                                         <%= hidden_field_tag "other_task4[]",y['Seq'],class: "form-control"  %></td>
                                        <% end %>
                                      </tr>
                                       <% end %>
                                    <tr><td colspan="3"><b><%=t('MANUFACTURER DATA')%></b></td></tr>
                                       <% for y in @data2 %>
                                         <tr>
                                      <%if y['property']=='MANUFACTURER REFERENCE'%>
                                         <td><b><%= link_to y.property , {:controller => :source_data,:action => :dictionary_detail, :esci => "  0161-1#02-132394#1"}, :target => "_blank",:def =>'' %></a></b></td>
                                         <td colspan="2">
                                        <% if y.value.nil? %>
                                        <%= text_field_tag "mfr1[]",y['value'],class: "form-control",placeholder: 'MFR NAME'%>                                  
                                          <button class="btn btn-info btn-xs"> <a data-toggle="modal" href="#modal-form-mfr"><%=t('BROWSE')%></a></button>
                                           <%= text_field_tag "mfr_partno[]",y['value'],class: "form-control",placeholder: 'MFR PART NO' %>
                                           <%= text_field_tag "mfr_url[]",y['value2'],class: "form-control",placeholder: 'MFR URL'%>
                                        <% else %>
                                         <%= text_field_tag "mfr1[]",y['value'].split(':')[0],class: "form-control",placeholder: 'MFR NAME'%>
                                           <input type="button" value="BROWSE" class="btn btn-info btn-xs"  data-toggle="modal" href="#modal-form-mfr" >

                                           <%= text_field_tag "mfr_partno[]",y['value'].split(':')[1],class: "form-control",placeholder: 'MFR PART NO' %>
                                           <%= text_field_tag "mfr_url[]",y['value2'],class: "form-control",placeholder: 'MFR URL'%>
                                          <% end %>
                                          <% if !y.value2.nil? %>
                                           <a href="<%=y.value2%>" name="mfr_url_view" id="mfr_url_view" class="fa fa-eye" target="_blank"></a>
                                          <% end %>
                                           <%= hidden_field_tag "mfr_task4[]",y['Seq'],class: "form-control" %>
                                           <%= hidden_field_tag "mfr[]",y['property'],class: "form-control" %>
                                           </td>
                                      <% end %>
                                      </tr>
                                        <% end %>
                               
                                      <tr id="add_sup"><td colspan="3"><b><%=t('SUPPLIER DATA')%></b> <input type="hidden" id="textid"></td></tr>
                                   <% @supp1=0 %>                    
                                        <% @data3.each do |y| %>
                                         <% @supp1=@supp1+=1%>
                                      <tr id="del_id<%=@supp1%>">
                                      <% if y['property']=='SUPPLIER REFERENCE' %> 
                                          <td><b><%= link_to y.property , {:controller => :source_data,:action => :dictionary_detail, :esci => "0161-1#02-128591#1"}, :target => "_blank",:def =>'' %> </b></td>
                                        <td>
                                        <% if y.value.nil? %>
                                          <input type="text" name="supp1[]" id="supp1_<%=@supp1%>" value="<%=y.value%>" class="form-control" placeholder='SUPP NAME'>
                                            <input type="button" name="brw" id="<%=@supp1%>" value="BROWSE" class="btn btn-info btn-xs"  data-toggle="modal" href="#modal-form-supp" onclick="getid(id);">
                                          <input type="text" name="supp_partno[]" id="supp_partno<%=@supp1%>" value="<%=y.value%>" class="form-control" placeholder="SUPP PART NO">
                                           <input type="text" name="supp_url[]" id="supp_url<%=@supp1%>" value="<%=y.value2%>" class="form-control" placeholder="SUPP URL">
                                          <%= hidden_field_tag "supp_task4[]",y['Seq'],class: "form-control" %>                                          
                                          <%= hidden_field_tag "supp[]",y.property,class: "form-control" %>
                                        <% if y.value2==""%>
                                           <a href="<%=y.value2%>" name="supp_url_view" id="supp_url_view" class="fa fa-eye" target="_blank"></a>
                                        <% end %>
                                           <% else %>
                                            <input type="text" name="supp1[]" id="supp1_<%=@supp1%>" value="<%=y.value.split(':')[0]%>" class="form-control" placeholder='SUPP NAME'>
                                            <input type="button" name="brw" id="<%=@supp1%>" value="BROWSE" class="btn btn-info btn-xs"  data-toggle="modal" href="#modal-form-supp" onclick="getid(id);">
                                          <input type="text" name="supp_partno[]" id="supp_partno<%=@supp1%>" value="<%=y.value.split(':')[1]%>" class="form-control" placeholder="SUPP PART NO">
                                           <input type="text" name="supp_url[]" id="supp_url<%=@supp1%>" value="<%=y.value2%>" class="form-control" placeholder="SUPP URL">
                                          <%= hidden_field_tag "supp_task4[]",y['Seq'],class: "form-control" %>                                          
                                          <%= hidden_field_tag "supp[]",y.property,class: "form-control" %>
                                        <% if y.value2!=""%>
                                           <a href="<%=y.value2%>" name="supp_url_view" id="supp_url_view" class="fa fa-eye" target="_blank"></a>
                                          <% end %>
                                               <% end %>                                   
                                            </td>
                                              <td>
                                          <input type="button" name="del_text" id="<%=@supp1%>" value="DEL" onclick="del('<%=@supp1%>:<%=y.Seq%>:<%=y.cat_id%>');" class="btn btn-danger btn-xs">
                                         <% if @supp1==@data4%>
                                              <input type="button" name="add_text" id="add_text<%=@supp1%>" value="ADD" onClick="add_ro(<%=@supp1%>);" class="btn btn-primary btn-xs">
                                          <% end %>
                                             </td>
                                      <% end %>
                                      <% end %>
                                      
                               </td></tr>
                              <tr id="place1" ><td colspan="3" id="place"></td></tr>

                                    <tr><td colspan="3"><b><%=t('BUSINESS UNIT')%></b></td></tr>
                                       <% for y in @data2%>
                                      <tr>
                                      <% if y['property']=='DRAWING NUMBER' || y['property']=='OTHER' %>
                                            <td><b><%= link_to y.property , {:controller => :source_data,:action => :dictionary_detail, :esci => "0161-1#02-148279#1"}, :target => "_blank",:def =>'' %></b></td>
                                        <td colspan="2"><%= text_field_tag "bu3[]",y['value'],class: "form-control" %>
                                        <%= hidden_field_tag "bu4[]",y['property'],class: "form-control" %>
                                         <%= hidden_field_tag "other_task5[]",y['Seq'],class: "form-control" %></td> 
                                      <% end %>
                                      </tr>
                                      <% end %>
                      </tr>
                    </div>
                  </table>
                  </div>
              </div>
            </div>
        </div>
      </div>
    <br>
      </div>

       <table class="table borderless">
                <tr>
                  <td>
                 <%- if I18n.locale== :ar %>
                    <span class="">
                      <% @ar_button = Language.select("language_property").where("language_id = ? AND controller_name = ? AND page_name = ? AND language_type = ? ", '45','langs','view.html.erb','ar')%>
                      <% @ar_button.each do |ar_button|%>
                      <%= submit_tag ar_button.language_property, :class=>"btn btn btn-primary pull-right", :style=>"margin:0;",:name=>nil %>
                       <% end %>
                    </span>
                  <% else %>
                    <span class="">
                      <% @en_button = Language.select("language_property").where("language_id = ? AND controller_name = ? AND page_name = ? AND language_type = ? ", '45','langs','view.html.erb','en')%>
                      <% @en_button.each do |en_button|%>
                       <%= submit_tag en_button.language_property, :class=>"btn btn btn-primary pull-right", :style=>"margin:0;",:name=>nil %>
                       <% end %>
                    </span>
                  <% end -%>
                  </td>
                </tr>
                </table> 
      </div>
</div>

<!--ADD MATERIAL-->

<% else %>
<div class="wrapper wrapper-content animated fadeInRight" >
  <div class="row">
     <div class="col-lg-8">
        <div class="ibox" style="border:1px solid #21B6A8;">
          <div class="ibox-title" style="background:#21B6A8;color:#f3f3f4 !important;">
        <h3><b><%=t('ADD NEW ITEM')%></b></h3>
              <div class="ibox-tools hide">
                  <a class="collapse-link" style="color:#f3f3f4 !important;">
                      <i class="fa fa-chevron-up"></i>
                  </a>
                 
                  <a class="close-link" style="color:#f3f3f4 !important;">
                      <i class="fa fa-times"></i>
                  </a>
              </div>
          </div>

          <div class="ibox-content">
           <table class="table table-bordered">

             <tr>
                 <td><b><%=t('CMM MATERIAL NO')%></b></td>
                 <td><input type="text" name="cmm" id="cmm" value="<%= @a %>" readonly="true" class="form-control"></td>
             </tr>
             <tr>
               <td><b><%=t('MATERIAL ID')%></b></td>
               <td><input type="text" name="material_id" id="material_id"  id="material_id" class="form-control"></td>
             </tr>
              <tr>
               <td><b><%=t('classname')%><font color="#FF0000">*</font></b></td>
               <td>
                 <input type="text" name="txt_class" id="txt_class" value="" readonly="true" class="form-control" >
                 <input type="hidden" name="txt_igid" id="txt_igid"  >
                 <input type="hidden" name="txt_classid" id="txt_classid"  >
                 <button class="btn btn-info btn-xs"><a data-toggle="modal" href="#modal-form" name="class1" id="class1" value="c1"><%=t('BROWSE')%></a></button>
                </td>
             </tr>
              <tr>
               <td><b><%=t('desc')%></b></td>
               <td><input type="text" name="desc" id="desc"  class="form-control"></td>
             </tr>
              <tr>
               <td><b><%=t('supplier name')%></b></td>
               <td>
                 <input type="text" name="txt_supplier" id="txt_supplier" value=""  class="form-control">
                  <input type="hidden" name="txt_supplier_id" id="txt_supplier_id" value=""  >
                 <button class="btn btn-info btn-xs"> <a data-toggle="modal" href="#modal-form1" name="supplier1" id="supplier1" value="s1" ><%=t('BROWSE1')%></a></button>
               </td>
             </tr>
              <tr>
               <td><b><%= t('supplier partno')%></b></td>
               <td><input type="text" name="supplier_id" id="supplier_id" class="form-control" ></td>
             </tr>
            </table>  
       <!--    <input type="button" name="send_request" id="send_request" value="Send Requset" class="btn btn-primary" onclick="send_req();"> -->
          <input type="button" name="catalog" id="catalog" value="<%=t('Proceed to Catalog this Item')%>" class="btn btn-primary" onclick="get_template();" >
      </div>
  <div id="txthint1"></div>
       </div>
    </div>
   </div>
  </div>
<% end %>
               <div class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" id="modal-form">
                <div class="modal-dialog modal-lg">
                  <div class="modal-content" style="border:2px solid #8A6D3B;">
                      <div class="modal-header" style="background:#8A6D3B;">
                          <button type="button" class="close" data-dismiss="modal" aria-label="Close"  style="color:#f3f3f4 !important;"><span aria-hidden="true">&times;</span></button>
                          <h4 class="modal-title" id="gridSystemModalLabel" style="color:#f3f3f4 !important;"><%=t('Class Name')%></h4>
                      </div>
                      <div class="modal-body">
                          <div class="row">
                              <div class="col-md-12" style="height: 400px !important;overflow: auto;">
                                 <table class="table table-striped table-bordered table-hover dataTables-example">
                                    <thead class="hide">
                                    <tr><th class="hide"></th></tr>
                                    </thead>
                                    <tbody>
                                     <% for x in @class_sel %>
                                        <tr>
                                          <td><input type="radio" name="class_sel" id="class_sel" onclick="getclass(this.value);" value="<%= x.Class_Name %>:<%=x.igref %>:<%= x.Class_id %>" ></td>
                                          <td><%= x.Class_Name %></td>
                                           <td class="hide"></td>
                                        </tr>  
                                    <% end %>
                                      </tbody>
                                    </table>
                              </div>
                          </div>  
                      </div>  
                  </div>
                </div>
              </div>
              <div class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" id="modal-form1">
                <div class="modal-dialog modal-lg">
                  <div class="modal-content" style="border:2px solid #2FADC1;">
                      <div class="modal-header" style="background:#2FADC1;">
                          <button type="button" class="close" data-dismiss="modal" aria-label="Close"  style="color:#f3f3f4 !important;"><span aria-hidden="true">&times;</span></button>
                          <h4 class="modal-title" id="gridSystemModalLabel" style="color:#f3f3f4 !important;"><%=t('Vendor Name')%></h4>
                      </div>
                      <div class="modal-body">
                          <div class="row">
                              <div class="col-md-12" style="height: 400px !important;overflow: auto;">
                                <table class="table table-striped table-bordered table-hover dataTables-example">
                                    <thead class="hide">
                                    <tr><th class="hide"></th></tr>
                                    </thead>
                                    <tbody>

                                     <% for v in @vendor%>
                                        <tr>  
                                          <td><input type="radio" name="supplier_sel" id="supplier_sel" onclick="getsupplier(this.value);" value="<%= v.Factory_Name %> ,<%= v.Factory_ID %>"></td>
                                         <td><%= link_to v.Factory_Name, {:controller => :langs,:action => :view,:Factory_ID => v.Factory_ID,:map =>'show'}, :target => "_blank"  %></td>
                                           <td class="hide"></td>
                                        </tr>  
                                    <% end %>
                                      </tbody>
                                    </table>
                              </div>
                          </div>  
                      </div>  
                  </div>
                </div>
              </div>   
              <div class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" id="modal-form-mfr">
                <div class="modal-dialog modal-lg">
                  <div class="modal-content" style="border:2px solid #8A6D3B;">
                      <div class="modal-header" style="background:#8A6D3B;">
                          <button type="button" class="close" data-dismiss="modal" aria-label="Close"  style="color:#f3f3f4 !important;"><span aria-hidden="true">&times;</span></button>
                          <h4 class="modal-title" id="gridSystemModalLabel" style="color:#f3f3f4 !important;"><%=t('Manufacturer Name')%></h4>
                      </div>
                      <div class="modal-body">
                          <div class="row">
                              <div class="col-md-12" style="height: 400px !important;overflow: auto;">
                                 <table class="table table-striped table-bordered table-hover dataTables-example">
                                    <thead class="hide">
                                    <tr><th class="hide"></th></tr>
                                    </thead>
                                    <tbody>
                                     <% for x in @vendor%>
                                        <tr>
                                          <td><input type="radio" name="class_sel" id="class_sel" class="class_sel" onclick="getmfr(this.value);" value="<%= x.Factory_Name %>:<%=x.Factory_ID %> %>"></td>
                                          <td><%= x.Factory_Name %></td>
                                         <td class="hide"></td>
                                        </tr> 
                                    <% end %>
                                      </tbody>
                                    </table>
                              </div>
                          </div>  
                      </div>  
                  </div>
                </div>
              </div>
             
              <div class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" id="modal-form-supp">
                <div class="modal-dialog modal-lg">
                  <div class="modal-content" style="border:2px solid #8A6D3B;">
                      <div class="modal-header" style="background:#8A6D3B;">
                          <button type="button" class="close" data-dismiss="modal" aria-label="Close"  style="color:#f3f3f4 !important;"><span aria-hidden="true">&times;</span></button>
                          <h4 class="modal-title" id="gridSystemModalLabel" style="color:#f3f3f4 !important;"><%=t('Supplier Name')%></h4>
                      </div>
                      <div class="modal-body">
                          <div class="row">
                              <div class="col-md-12" style="height: 400px !important;overflow: auto;">
                                 <table class="table table-striped table-bordered table-hover dataTables-example">
                                    <thead class="hide">
                                    <tr><th class="hide"></th></tr>
                                    </thead>
                                    <tbody>
                                     <% for x in @vendor%>
                                        <tr>
                                          <td>
                                          <input type="radio" name="class_sel" id="class_sel" class="class_sel" onclick="getsupp(this.value);" value="<%= x.Factory_Name %>:<%=x.Factory_ID%> "></td>
                                          <td><%= x.Factory_Name %></td>
                                         <td class="hide"></td>
                                        </tr> 
                                    <% end %>
                                      </tbody>
                                    </table>
                              </div>
                          </div>  
                      </div>  
                  </div>
                </div>
              </div>
              <div class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" id="modal-form-supp1">
                <div class="modal-dialog modal-lg">
                  <div class="modal-content" style="border:2px solid #8A6D3B;">
                      <div class="modal-header" style="background:#8A6D3B;">
                          <button type="button" class="close" data-dismiss="modal" aria-label="Close"  style="color:#f3f3f4 !important;"><span aria-hidden="true">&times;</span></button>
                          <h4 class="modal-title" id="gridSystemModalLabel" style="color:#f3f3f4 !important;"><%=t('Supplier Name')%></h4>
                      </div>
                      <div class="modal-body">
                          <div class="row">
                              <div class="col-md-12" style="height: 400px !important; overflow: auto;">
                                 <table class="table table-striped table-bordered table-hover dataTables-example">
                                    <thead class="hide">
                                    <tr><th class="hide"></th></tr>
                                    </thead>
                                    <tbody>
                                     <% for x in @vendor%>
                                        <tr>
                                          <td>
                                          <input type="radio" name="class_sel" id="class_sel" class="class_sel" onclick="getsupp1(this.value);" value="<%= x.Factory_Name %>:<%=x.Factory_ID%>:<%=@supp1%> "></td>
                                          <td><%= x.Factory_Name %></td>
                                         <td class="hide"></td>
                                        </tr> 
                                    <% end %>
                                      </tbody>
                                    </table>
                              </div>
                          </div>  
                      </div>  
                  </div>
                </div>
               <div class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" id="modal-form-newclass">
                <div class="modal-dialog modal-lg">
                  <div class="modal-content" style="border:2px solid #8A6D3B;">
                      <div class="modal-header" style="background:#8A6D3B;">
                          <button type="button" class="close" data-dismiss="modal" aria-label="Close"  style="color:#f3f3f4 !important;"><span aria-hidden="true">&times;</span></button>
                          <h4 class="modal-title" id="gridSystemModalLabel" style="color:#f3f3f4 !important;"><%=t('Class Name')%></h4>
                      </div>
                      <div class="modal-body">
                          <div class="row">
                              <div class="col-md-12" style="height: 400px !important;overflow: auto;">
                                 <table class="table table-striped table-bordered table-hover dataTables-example">
                                    <thead class="hide">
                                    <tr><th class="hide"></th></tr>
                                    </thead>
                                    <tbody>
                                     <% for x in @class_sel%>
                                        <tr>
                                          <td><input type="radio" name="class_sel" id="class_sel" class="class_sel" onclick="getnewclass(this.value);" value="<%= x.Class_Name %>:<%=x.igref %>:<%= x.Class_id %>"></td>
                                          <td><%= x.Class_Name %></td>
                                           <td class="hide"></td>
                                        </tr>  
                                    <% end %>
                                      </tbody>
                                    </table>
                              </div>
                          </div>  
                      </div>  
                  </div>
                </div>
              </div>

<% end %>

<% content_for :javascript do %>

<script type="text/javascript">
$(function() {    
     // alert("test");
      $('#change_class1 td:nth-child(3)').hide(); 
      $('#change_class1 th:nth-child(3)').hide(); 
      $('#change_class1 td:nth-child(4)').hide(); 
      $('#change_class1 th:nth-child(4)').hide(); 
      $('#change_class1 td:nth-child(5)').hide(); 
      $('#change_class1 th:nth-child(5)').hide(); 
      $('#toggle').click(function() {
        $('#change_class1 td:nth-child(3)').toggle(); 
        $('#change_class1 th:nth-child(3)').toggle(); 
      $('#change_class1 td:nth-child(4)').toggle(); 
      $('#change_class1 th:nth-child(4)').toggle(); 
      $('#change_class1 td:nth-child(5)').toggle(); 
      $('#change_class1 th:nth-child(5)').toggle(); 
     
      });
    });
    function imgres()
    {
      $('#imagepreview').attr('src', $('#imageresource').attr('src')); 
      $('#imagemodal').modal('show'); 
    }

    $(function(val) {
        $('input[name=class_sel][type="radio"]').on('change', function(event) {
            $('#catalog').attr("disabled", false);
        });
    });
    $(function() {
  $('#img_chk').on('click',function(event){
    $('#pictureInput').attr("value",'')
    alert("select the image");
    return false;
  $('#pictureInput').on('change', function(event) {
    var files = event.target.files;
    var image = files[0]
    var reader = new FileReader();
    reader.onload = function(file) {
    $('#imgprev').attr('src',file.target.result)
    };
    reader.readAsDataURL(image);
    console.log(files);
  });

});
});

  function getclass(val)
  {
    $('#modal-form').modal('hide');
 var classname=val.split(':');
 document.getElementById("txt_class").value = classname[0];
 document.getElementById("txt_igid").value=classname[1];
 document.getElementById("txt_classid").value=classname[2];
  }
  function getsupplier(val1)
  {
    $('#modal-form1').modal('hide');
    var factory = val1.split(',');
 document.getElementById("txt_supplier_id").value = factory[1];
 document.getElementById("txt_supplier").value = factory[0];

  }
 function get_template()
  {
  if(document.getElementById("txt_class").value =="")
    {
    alert("<%= I18n.t 'Enter the class name'%>");
    return false;
    }
  
  catalog.disabled = "disabled"; 
if (window.XMLHttpRequest)
  {// code for IE7+, Firefox, Chrome, Opera, Safari
  xmlhttp=new XMLHttpRequest();
  }
else
  {// code for IE6, IE5
  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  }
xmlhttp.onreadystatechange=function()
  {
  if (xmlhttp.readyState==4 && xmlhttp.status==200)
    {
    document.getElementById("txthint1").innerHTML=xmlhttp.responseText;
    }
  }

var txt_class=document.getElementById("txt_class").value;
var txt_supplier=document.getElementById("txt_supplier").value;
xmlhttp.open("GET","get_template_ksa?class="+txt_class+"&supplier="+txt_supplier,true);
xmlhttp.setRequestHeader("Content-Type", "application/json");
xmlhttp.send();
}


$(function() {

    $('.dataTables-example').dataTable({
        "dom": 'T<"clear">lfrtip',
        "tableTools": {
            "sSwfPath": "../assets/dataTables/swf/copy_csv_xls_pdf.swf"
        }
    });

    /* Init DataTables */
    var oTable = $('#editable').dataTable();

    /* Apply the jEditable handlers to the table */
    oTable.$('td').editable( '../example_ajax.php', {
        "callback": function( sValue, y ) {
            var aPos = oTable.fnGetPosition( this );
            oTable.fnUpdate( sValue, aPos[0], aPos[1] );
        },
        "submitdata": function ( value, settings ) {
            return {
                "row_id": this.parentNode.getAttribute('id'),
                "column": oTable.fnGetPosition( this )[2]
            };
        },

        "width": "90%",
        "height": "100%"
    } );


});
  function getmfr(val2)
  {
    $('#modal-form-mfr').modal('hide');
 var manufacture=val2.split(':');
 document.getElementById("mfr1_").value = manufacture[0];

  }
   function getsupp(val3)
  {
    $('#modal-form-supp').modal('hide');   
 var supplier=val3.split(':');
 //var z=document.getElementById("brw");
 var x=document.getElementById('textid').value;
//alert(x);
  document.getElementById("supp1_"+x);
  document.getElementById("brw"+x);
  document.getElementById("supp1_"+x).value=supplier[0];

   }
    function getsupp1(val3)
  {
    $('#modal-form-supp1').modal('hide');
 var supplier=val3.split(':');
 document.getElementById("supp1_").value = supplier[0];
  }
 function getnewclass(val4)
 {
   $('#modal-form-newclass').modal('hide');
   var str=confirm("to change class?");
   var newclassname=val4.split(':');
  
  if(str==true)
  {
  var prop=document.getElementById("change_class1");
  document.getElementById("newclass").innerHTML= newclassname[0];
  prop.style.display='none';
  }
  else
  {
  return false;
  }
   if (window.XMLHttpRequest)
  {// code for IE7+, Firefox, Chrome, Opera, Safari
  xmlhttp=new XMLHttpRequest();
  }
else
  {// code for IE6, IE5
  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  }
xmlhttp.onreadystatechange=function()
  {
  if (xmlhttp.readyState==4 && xmlhttp.status==200)
    {
    document.getElementById("change_class").innerHTML=xmlhttp.responseText;
    }
  }

xmlhttp.open("GET","change_class_ksa?class="+ newclassname[0],true);
xmlhttp.setRequestHeader("Content-Type", "application/json");
xmlhttp.send();
 }

function add_ro(va)
{
  va=+va+1;
  var v=+va-1;
  if(document.getElementById("supp1_"+v).value!="")
  {
   document.getElementById("add_text"+v).style.display = "none";
  $('#place').append('<tr id="show'+va+'"><td style="width:290px"><a href=""><b>SUPPLIER REFERENCE</b></a></td><td>&nbsp;<input type="text" name="supp1_new[]" id="supp1_'+va+'" placeholder="SUPPLIER NAME" class="form-control"  />&nbsp;&nbsp;<input name="brw" id='+va+' type="button" value="BROWSE" class="btn btn-info btn-xs" onClick="getid(id);" data-toggle="modal" href="#modal-form-supp">&nbsp;&nbsp;<input type="text" name="supp_new_partno[]" id="supp_partno'+va+'" placeholder="SUPP PART NO" class="form-control">&nbsp;&nbsp;<input type="text" name="supp_new_url[]" id="supp_url'+va+'"  placeholder="SUPP URL" class="form-control"> <input type="hidden" name="supp_id2" id="supp_new_id2" value="1"><td>&nbsp;&nbsp;</td><td><input type="button" value="ADD" class="btn btn-primary btn-xs" id="add_text'+va+'" onClick="add_ro('+va+');"/>&nbsp;&nbsp;</td></tr>');
  }
 else
{
   alert("please fill Existing row");
}
}

function del(id1)
{
  var a1=id1.split(':');
  alert(a1[0]);
  alert(a1[1]);
  alert(a1[2]);
  var a2=a1[0];
  var a3=a1[1];
  var a4=a1[2];
  alert("want to delete supplier?");
  var str=confirm("to delete supplier?");
  if(str==true)
  {
    if (window.XMLHttpRequest)
  {// code for IE7+, Firefox, Chrome, Opera, Safari
  xmlhttp=new XMLHttpRequest();
  }
else
  {// code for IE6, IE5
  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  }
xmlhttp.onreadystatechange=function()
  {
  }
xmlhttp.open("GET","delete_supp_ksa?supp_seq="+a3+"&prop="+a2+"&cat_id="+a4,true);
xmlhttp.setRequestHeader("Content-Type", "application/json");
xmlhttp.send();
}
else
{
  return false;
}
}

  
function getid(id){
  document.getElementById('textid').value=id
} 

// function add()
// {
//   var total_text=document.getElementsByClassName("input_text");
//   total_text=total_text.length+1;
//   document.getElementById("place").innerHTML=document.getElementById("place").innerHTML+
//   "<p id='input_text"+total_text+"_wrapper'><input type='text' class='input_text' id='bu1_' name='bu[]' placeholder='Enter Text'><input type='button' value='Remove' onclick=remove_field('input_text"+total_text+"');></p>";
// }
// function remove_field(id)
// {
//   document.getElementById(id+"_wrapper").innerHTML="";
// }
</script>

<% end %>